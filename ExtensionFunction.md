# 拓展功能

这篇文档将对我实现的 `Mini_Lisp` 解释器中与标准 `Mini_Lisp` 不同的地方以及我添加的地方做出说明。关于 `Mini_Lisp` 标准文档，详见[标准文档](https://pku-software.github.io/mini-lisp-spec/)。

### 与标准 `Mini_Lisp` 不同的内置过程

#### 减法过程

标准 `Mini_Lisp` 要求的是实现至多两个数之间的相减，我实现的这个解释器采用的是可以接受多个参数，如果参数超过2个，那么将会用第一个数依次减去后面所有的数。下面的样例

```lisp
(- 1 2 3)
```

返回的将是 -4。
其他的情况与标准 `Mini_Lisp`的相同。

### 新增的拓展内容

#### 1. REPL多行读入

本 `Mini_Lisp` 解释器支持的REPL多行读入是指，当输入的语句尚未完成时若用户按下回车键，将不会报错，而是允许用户在下一行继续输入后续内容。如果出现括号不匹配，则会报错退出。具体的就是，比如下面这个样例是可以通过解释的：

```lisp
(define x
    2)
```

将会将 `x` 定义为2，并返回空表

但下面这个案例将不能通过解释：

```lisp
(define x
    )) 
```

将会报错 "Unmatched parens"

#### 2. 文件多行读入

本  `Mini_Lisp` 解释器支持文本的多行读入。也就是说文件的语句不必写在一行，而是可以跨行。与REPL模式相近的，下面的语句可以通过解释：

```lisp
(define x
    2)
```

将会将 `x` 定义为2，并返回空表

但下面这个案例将不能通过解释：

```lisp
(define x
    )) 
```

将会报错 "Unmatched parens"。

#### 3. 字符串操作

字符串操作是比较常见的一种操作，字符串的比较已经在  `equal?` 和 `eq?` 过程中实现，这里再实现比较常用的字符串长度和字符串拼接函数。

1. **字符串长度**：
   
   求字符串长度的内置过程是 `strlen` ，使用的时候需要给出一个字符串类型的变量，比如：
   ```lisp
   strlen("abc")
   ```
   而接受其他类型的变量或者接受的参数数量低于或超过1个都会报错。
2. **字符串拼接**：
   
   进行字符串拼接的内置过程时 `strappend` ，使用的时候需要给出两个字符串类型的变量，比如：
   ```lisp
   strappend("abc", "def")
   ```
   而接受其他类型的变量或者接受的参数数量低于或超过2个都会报错。
